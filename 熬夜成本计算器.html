<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç†¬å¤œæˆæœ¬è®¡ç®—å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .progress-bar {
            height: 4px;
            background: #f0f0f0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        .content {
            padding: 30px 20px;
        }

        .step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 25px;
            color: #667eea;
            text-align: center;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            font-size: 15px;
            font-weight: 500;
            margin-bottom: 10px;
            color: #555;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 14px 16px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .radio-option:hover {
            border-color: #667eea;
            background: white;
        }

        .radio-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            accent-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #666;
            margin-top: 10px;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .result-section {
            text-align: center;
            padding: 20px 0;
        }

        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .result-card.warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .result-card.danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }

        .result-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .result-unit {
            font-size: 16px;
            opacity: 0.9;
        }

        .result-details {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 4px;
        }

        .detail-explanation {
            font-size: 11px;
            color: #999;
            line-height: 1.4;
        }

        .detail-value {
            font-size: 16px;
            font-weight: 600;
            color: #667eea;
            margin-left: 15px;
            min-width: 100px;
            text-align: right;
        }

        .detail-value.danger {
            color: #ff6b6b;
        }

        .risk-section {
            background: #fff5f5;
            border-left: 4px solid #ff6b6b;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .risk-title {
            font-size: 16px;
            font-weight: 600;
            color: #ff6b6b;
            margin-bottom: 15px;
        }

        .risk-item {
            display: flex;
            align-items: flex-start;
            padding: 10px 0;
            font-size: 14px;
            color: #555;
        }

        .risk-icon {
            margin-right: 10px;
            font-size: 18px;
        }

        .tips-section {
            background: #f0f9ff;
            border-left: 4px solid #667eea;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }

        .tips-title {
            font-size: 16px;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 15px;
        }

        .tip-item {
            padding: 10px 0;
            font-size: 14px;
            color: #555;
            display: flex;
            align-items: flex-start;
        }

        .tip-icon {
            margin-right: 10px;
            font-size: 18px;
        }

        .reference-section {
            background: #fafafa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid #e0e0e0;
        }

        .reference-title {
            font-size: 16px;
            font-weight: 600;
            color: #555;
            margin-bottom: 15px;
        }

        .reference-list {
            font-size: 12px;
            color: #666;
            line-height: 1.8;
        }

        .reference-item {
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .reference-item:last-child {
            border-bottom: none;
        }

        .reference-item strong {
            color: #667eea;
        }

        .comparison {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .comparison-text {
            font-size: 15px;
            color: #555;
        }

        .comparison-highlight {
            font-weight: 700;
            color: #667eea;
            font-size: 18px;
        }

        .footer {
            text-align: center;
            padding: 20px;
            font-size: 12px;
            color: #999;
            background: #f8f9fa;
        }

        .disclaimer {
            font-size: 11px;
            color: #999;
            text-align: center;
            padding: 15px 20px;
            background: #f8f9fa;
            line-height: 1.6;
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 20px;
            }

            .result-value {
                font-size: 36px;
            }

            .detail-value {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒ™ ç†¬å¤œæˆæœ¬è®¡ç®—å™¨</h1>
            <p>åŸºäºæƒå¨ç ”ç©¶æ•°æ® Â· 30ç§’ç®—å‡ºä½ çš„ç†¬å¤œä»£ä»·</p>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="content">
            <!-- æ­¥éª¤1ï¼šåŸºç¡€ä¿¡æ¯ -->
            <div class="step active" id="step1">
                <h2 class="step-title">ç¬¬ä¸€æ­¥ï¼šåŸºæœ¬ä¿¡æ¯</h2>
                
                <div class="form-group">
                    <label class="form-label">ä½ çš„å¹´é¾„</label>
                    <input type="number" class="form-input" id="age" placeholder="è¯·è¾“å…¥å¹´é¾„" min="10" max="100">
                </div>

                <div class="form-group">
                    <label class="form-label">ä½ çš„æ€§åˆ«</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="gender" value="male">
                            <span>ç”·</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="gender" value="female">
                            <span>å¥³</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        æœˆæ”¶å…¥ï¼ˆå…ƒï¼‰
                        <span style="font-size: 12px; color: #999; display: block; margin-top: 5px; font-weight: normal;">
                            ğŸ“Œ ç”¨äºè®¡ç®—ï¼šæ”¶å…¥æŸå¤±ã€æ•ˆç‡æŸå¤±ç­‰ç»æµå½±å“
                        </span>
                        <span style="font-size: 12px; color: #999; font-weight: normal;">
                            ğŸ“š æ¥æºï¼šRAND Corporation ç¡çœ ç»æµç ”ç©¶æŠ¥å‘Š
                        </span>
                    </label>
                    <input type="number" class="form-input" id="income" placeholder="è¯·è¾“å…¥ä½ çš„æœˆæ”¶å…¥" min="0">
                </div>

                <button class="btn btn-primary" onclick="nextStep(2)">ä¸‹ä¸€æ­¥</button>
            </div>

            <!-- æ­¥éª¤2ï¼šç†¬å¤œä¹ æƒ¯ -->
            <div class="step" id="step2">
                <h2 class="step-title">ç¬¬äºŒæ­¥ï¼šç†¬å¤œä¹ æƒ¯</h2>
                
                <div class="form-group">
                    <label class="form-label">æ¯å‘¨ç†¬å¤œå¤©æ•°</label>
                    <select class="form-select" id="stayLateDays">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="0">å‡ ä¹ä¸ç†¬å¤œ</option>
                        <option value="1">1å¤©</option>
                        <option value="2">2å¤©</option>
                        <option value="3">3å¤©</option>
                        <option value="4">4å¤©</option>
                        <option value="5">5å¤©</option>
                        <option value="6">6å¤©</option>
                        <option value="7">å¤©å¤©ç†¬å¤œ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">é€šå¸¸å…¥ç¡æ—¶é—´</label>
                    <select class="form-select" id="sleepTime">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="21">21:00 åŠä¹‹å‰</option>
                        <option value="22">22:00-22:59</option>
                        <option value="23">23:00-23:59</option>
                        <option value="0">00:00-00:59</option>
                        <option value="1">01:00-01:59</option>
                        <option value="2">02:00-02:59</option>
                        <option value="3">03:00 åŠä¹‹å</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">å¹³å‡æ¯æ™šç¡çœ æ—¶é•¿</label>
                    <select class="form-select" id="sleepDuration">
                        <option value="">è¯·é€‰æ‹©</option>
                        <option value="9">9 å°æ—¶åŠä»¥ä¸Š</option>
                        <option value="8">7-9 å°æ—¶</option>
                        <option value="6">6-7 å°æ—¶</option>
                        <option value="5">5-6 å°æ—¶</option>
                        <option value="4">5 å°æ—¶ä»¥ä¸‹</option>
                    </select>
                </div>

                <button class="btn btn-primary" onclick="nextStep(3)">ä¸‹ä¸€æ­¥</button>
                <button class="btn btn-secondary" onclick="prevStep(1)">ä¸Šä¸€æ­¥</button>
            </div>

            <!-- æ­¥éª¤3ï¼šç¡çœ è´¨é‡ -->
            <div class="step" id="step3">
                <h2 class="step-title">ç¬¬ä¸‰æ­¥ï¼šç¡çœ è´¨é‡</h2>
                
                <div class="form-group">
                    <label class="form-label">å…¥ç¡éœ€è¦å¤šä¹…ï¼Ÿ</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="fallAsleepTime" value="0">
                            <span>15åˆ†é’Ÿä»¥å†…</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="fallAsleepTime" value="1">
                            <span>16-30åˆ†é’Ÿ</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="fallAsleepTime" value="2">
                            <span>31-60åˆ†é’Ÿ</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="fallAsleepTime" value="3">
                            <span>60åˆ†é’Ÿä»¥ä¸Š</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">ç™½å¤©ç²¾åŠ›çŠ¶æ€å¦‚ä½•ï¼Ÿ</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="dayEnergy" value="0">
                            <span>ç²¾åŠ›å……æ²›ï¼Œæ— å›°å€¦</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="dayEnergy" value="1">
                            <span>å¶å°”å›°å€¦</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="dayEnergy" value="2">
                            <span>ç»å¸¸æ„Ÿåˆ°ç–²æƒ«</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="dayEnergy" value="3">
                            <span>ä¸¥é‡å›°å€¦ï¼Œå½±å“ç”Ÿæ´»</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">å¤œé—´æ˜¯å¦å®¹æ˜“é†’æ¥ï¼Ÿ</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="wakeUp" value="0">
                            <span>ä¸é†’æ¥ï¼Œä¸€è§‰åˆ°å¤©äº®</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="wakeUp" value="1">
                            <span>å¶å°”é†’æ¥</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="wakeUp" value="2">
                            <span>ç»å¸¸é†’æ¥</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="wakeUp" value="3">
                            <span>å‡ ä¹æ¯å°æ—¶éƒ½é†’</span>
                        </label>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="calculateResult()">å¼€å§‹è®¡ç®—</button>
                <button class="btn btn-secondary" onclick="prevStep(2)">ä¸Šä¸€æ­¥</button>
            </div>

            <!-- ç»“æœé¡µé¢ -->
            <div class="step" id="step4">
                <h2 class="step-title">ğŸ“Š ä½ çš„ç†¬å¤œæˆæœ¬æŠ¥å‘Š</h2>
                
                <div class="result-section">
                    <div class="result-card" id="resultCard">
                        <div class="result-label">å¹´åº¦ç†¬å¤œæŸå¤±</div>
                        <div class="result-value"><span id="totalLoss">0</span></div>
                        <div class="result-unit">å…ƒ</div>
                    </div>

                    <div class="comparison">
                        <div class="comparison-text">
                            ä½ å‡»è´¥äº† <span class="comparison-highlight" id="beatPercent">0%</span> çš„ç†¬å¤œè€…<br>
                            <small>ç¡çœ è´¨é‡è¯„åˆ†ï¼š<span id="sleepScore">0</span>/9 åˆ†</small>
                        </div>
                    </div>
                </div>

                <div class="result-details">
                    <div class="detail-item">
                        <div style="flex: 1;">
                            <div class="detail-label">ğŸ’Š åŒ»ç–—é¢å¤–æ”¯å‡º</div>
                            <div class="detail-explanation" id="medicalCostExplanation"></div>
                        </div>
                        <div class="detail-value" id="medicalCost">0 å…ƒ/å¹´</div>
                    </div>
                    <div class="detail-item">
                        <div style="flex: 1;">
                            <div class="detail-label">ğŸ’¸ æ”¶å…¥æŸå¤±</div>
                            <div class="detail-explanation" id="incomeLossExplanation"></div>
                        </div>
                        <div class="detail-value" id="incomeLoss">0 å…ƒ/å¹´</div>
                    </div>
                    <div class="detail-item">
                        <div style="flex: 1;">
                            <div class="detail-label">ğŸ“‰ æ•ˆç‡æŸå¤±</div>
                            <div class="detail-explanation" id="efficiencyLossExplanation"></div>
                        </div>
                        <div class="detail-value danger" id="efficiencyLoss">0 å…ƒ/å¹´</div>
                    </div>
                    <div class="detail-item">
                        <div style="flex: 1;">
                            <div class="detail-label">ğŸ’… é¢œå€¼ä¿®å¤æˆæœ¬</div>
                            <div class="detail-explanation" id="beautyCostExplanation"></div>
                        </div>
                        <div class="detail-value" id="beautyCost">0 å…ƒ/å¹´</div>
                    </div>
                </div>

                <div class="risk-section">
                    <div class="risk-title">âš ï¸ å¥åº·é£é™©è­¦æŠ¥</div>
                    <div class="risk-item">
                        <span class="risk-icon">â¤ï¸</span>
                        <span id="heartRisk">å¿ƒè¡€ç®¡ç–¾ç—…é£é™©ï¼šæ­£å¸¸</span>
                    </div>
                    <div class="risk-item">
                        <span class="risk-icon">ğŸ¬</span>
                        <span id="diabetesRisk">ç³–å°¿ç—…é£é™©ï¼šæ­£å¸¸</span>
                    </div>
                    <div class="risk-item">
                        <span class="risk-icon">ğŸ§ </span>
                        <span id="brainRisk">è®¤çŸ¥åŠŸèƒ½ï¼šæ­£å¸¸</span>
                    </div>
                    <div class="risk-item">
                        <span class="risk-icon">â³</span>
                        <span id="agingRisk">è¡°è€åŠ é€Ÿï¼š0 å¹´</span>
                    </div>
                    <div class="risk-item">
                        <span class="risk-icon">ğŸ˜¢</span>
                        <span id="depressionRisk">æŠ‘éƒé£é™©ï¼šæ­£å¸¸</span>
                    </div>
                </div>

                <div class="tips-section">
                    <div class="tips-title">ğŸ’¡ ç«‹å³å¯åšçš„3ä»¶äº‹</div>
                    <div class="tip-item">
                        <span class="tip-icon">1ï¸âƒ£</span>
                        <span>ä»Šæ™šæå‰1å°æ—¶ä¸ŠåºŠï¼Œç¡å‰1å°æ—¶ä¸çœ‹æ‰‹æœº</span>
                    </div>
                    <div class="tip-item">
                        <span class="tip-icon">2ï¸âƒ£</span>
                        <span>ç¡å‰æ´—ä¸ªçƒ­æ°´æ¾¡æˆ–ç”¨æ¸©æ°´æ³¡è„š10åˆ†é’Ÿ</span>
                    </div>
                    <div class="tip-item">
                        <span class="tip-icon">3ï¸âƒ£</span>
                        <span>å›ºå®šèµ·åºŠæ—¶é—´ï¼Œå³ä½¿æ˜¯å‘¨æœ«ä¹Ÿè¦åšæŒ</span>
                    </div>
                </div>

                <div class="reference-section">
                    <div class="reference-title">ğŸ“š å‚è€ƒæ–‡çŒ®ä¸æ•°æ®æ¥æº</div>
                    <div class="reference-list">
                        <div class="reference-item">
                            <strong>Nature Medicine (2026)</strong><br>
                            SleepFMæ¨¡å‹ï¼šåŸºäº6.5ä¸‡äººã€58.5ä¸‡å°æ—¶ç¡çœ æ•°æ®ï¼Œé¢„æµ‹130ç§ç–¾ç—…é£é™©ï¼Œå…¨å› æ­»äº¡ç‡é¢„æµ‹å‡†ç¡®ç‡84%
                        </div>
                        <div class="reference-item">
                            <strong>Nature Communications (2025)</strong><br>
                            ç¡çœ ä¸å¥åº·ï¼ˆUSPï¼‰ä¸76ç§ç–¾ç—…æ˜¾è‘—ç›¸å…³ï¼Œå¿ƒè¡€ç®¡ç–¾ç—…é£é™©å¢åŠ 35%ï¼Œå…¨å› æ­»äº¡ç‡å¢åŠ 32%
                        </div>
                        <div class="reference-item">
                            <strong>RAND Corporation</strong><br>
                            ç¡çœ ä¸è¶³å¯¼è‡´ç¾å›½å¹´ç»æµæŸå¤±4110äº¿ç¾å…ƒï¼Œä¸­å›½6281.5äº¿ç¾å…ƒï¼ˆå GDP 4.62%ï¼‰
                        </div>
                        <div class="reference-item">
                            <strong>ç¡çœ å¥åº·ç ”ç©¶</strong><br>
                            ç¡çœ <6å°æ—¶äººç¾¤åŒ»ç–—æ”¯å‡ºé«˜47%ï¼Œå¹´æ”¶å…¥å‡å°‘12.5%ï¼Œåˆ›æ„äº§å‡ºä¸‹é™41%
                        </div>
                        <div class="reference-item">
                            <strong>åŒ¹å…¹å ¡ç¡çœ è´¨é‡æŒ‡æ•° (PSQI)</strong><br>
                            1989å¹´å¼€å‘ï¼Œä¿¡åº¦Î±=0.83ï¼Œå¹¿æ³›ç”¨äºç¡çœ è´¨é‡è¯„ä¼°
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="location.reload()">é‡æ–°æµ‹è¯•</button>
            </div>
        </div>

        <div class="disclaimer">
            âš ï¸ å…è´£å£°æ˜ï¼šæœ¬å·¥å…·åŸºäºæƒå¨åŒ»å­¦ç ”ç©¶æ•°æ®è®¡ç®—ï¼Œç»“æœä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆåŒ»ç–—è¯Šæ–­å»ºè®®ã€‚å¦‚é‡ä¸¥é‡ç¡çœ é—®é¢˜ï¼Œè¯·åŠæ—¶å°±åŒ»ã€‚
        </div>

        <div class="footer">
            æ•°æ®æ¥æºï¼šNature Medicineã€æŸ³å¶åˆ€ã€RAND Corporationç­‰æƒå¨ç ”ç©¶
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 3;

        function updateProgress() {
            const progress = ((currentStep - 1) / totalSteps) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function nextStep(step) {
            // éªŒè¯å½“å‰æ­¥éª¤
            if (currentStep === 1) {
                const age = document.getElementById('age').value;
                const income = document.getElementById('income').value;
                const gender = document.querySelector('input[name="gender"]:checked');
                
                if (!age || age < 10 || age > 100) {
                    alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹´é¾„ï¼ˆ10-100å²ï¼‰');
                    return;
                }
                if (!gender) {
                    alert('è¯·é€‰æ‹©æ€§åˆ«');
                    return;
                }
                if (!income || income < 0) {
                    alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æœˆæ”¶å…¥');
                    return;
                }
            }

            if (currentStep === 2) {
                const stayLateDays = document.getElementById('stayLateDays').value;
                const sleepTime = document.getElementById('sleepTime').value;
                const sleepDuration = document.getElementById('sleepDuration').value;
                
                if (!stayLateDays) {
                    alert('è¯·é€‰æ‹©æ¯å‘¨ç†¬å¤œå¤©æ•°');
                    return;
                }
                if (!sleepTime) {
                    alert('è¯·é€‰æ‹©å…¥ç¡æ—¶é—´');
                    return;
                }
                if (!sleepDuration) {
                    alert('è¯·é€‰æ‹©ç¡çœ æ—¶é•¿');
                    return;
                }
            }

            document.getElementById('step' + currentStep).classList.remove('active');
            currentStep = step;
            document.getElementById('step' + currentStep).classList.add('active');
            updateProgress();
            window.scrollTo(0, 0);
        }

        function prevStep(step) {
            document.getElementById('step' + currentStep).classList.remove('active');
            currentStep = step;
            document.getElementById('step' + currentStep).classList.add('active');
            updateProgress();
            window.scrollTo(0, 0);
        }

        function calculateResult() {
            // éªŒè¯æ­¥éª¤3
            const fallAsleepTime = document.querySelector('input[name="fallAsleepTime"]:checked');
            const dayEnergy = document.querySelector('input[name="dayEnergy"]:checked');
            const wakeUp = document.querySelector('input[name="wakeUp"]:checked');
            
            if (!fallAsleepTime || !dayEnergy || !wakeUp) {
                alert('è¯·å®Œæˆæ‰€æœ‰é—®é¢˜');
                return;
            }

            // è·å–æ•°æ®
            const age = parseInt(document.getElementById('age').value);
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const monthlyIncome = parseInt(document.getElementById('income').value);
            const stayLateDays = parseInt(document.getElementById('stayLateDays').value);
            const sleepTimeHour = parseInt(document.getElementById('sleepTime').value);
            const sleepDuration = parseInt(document.getElementById('sleepDuration').value);
            
            // ç¡çœ è´¨é‡è¯„åˆ†ï¼ˆç®€åŒ–ç‰ˆPSQIï¼Œ0-9åˆ†ï¼Œåˆ†æ•°è¶Šé«˜è¶Šå·®ï¼‰
            const fallAsleepTimeScore = parseInt(fallAsleepTime.value);
            const dayEnergyScore = parseInt(dayEnergy.value);
            const wakeUpScore = parseInt(wakeUp.value);
            const sleepScore = fallAsleepTimeScore + dayEnergyScore + wakeUpScore;

            // å¹´æ”¶å…¥
            const annualIncome = monthlyIncome * 12;

            // è®¡ç®—ç»æµæˆæœ¬
            // 1. åŒ»ç–—é¢å¤–æ”¯å‡ºï¼šåŸºäºç¾å›½ç ”ç©¶ï¼Œç¡çœ <6å°æ—¶äººç¾¤å¹´å‡é¢å¤–åŒ»ç–—æ”¯å‡º1278ç¾å…ƒï¼ˆçº¦8300å…ƒï¼‰
            let sleepDurationScore = 0;
            if (sleepDuration <= 5) sleepDurationScore = 3;
            else if (sleepDuration <= 6) sleepDurationScore = 2;
            else if (sleepDuration <= 8) sleepDurationScore = 1;
            else sleepDurationScore = 0;

            // åŸºç¡€åŒ»ç–—æ”¯å‡ºå¢åŠ ï¼š8300å…ƒ/å¹´ï¼ˆRANDç ”ç©¶ï¼š1278ç¾å…ƒ Ã— 6.5æ±‡ç‡ï¼‰
            const baseMedicalCost = 8300;
            const medicalCostMultiplier = sleepDurationScore / 3; // 0-1
            const medicalCost = Math.round(baseMedicalCost * medicalCostMultiplier);

            // 2. æ”¶å…¥æŸå¤±ï¼šç¡çœ <6å°æ—¶å¹´æ”¶å…¥å°‘12.5%
            const incomeLossMultiplier = sleepDurationScore / 3; // 0-1
            const incomeLoss = Math.round(annualIncome * 0.125 * incomeLossMultiplier);

            // 3. æ•ˆç‡æŸå¤±ï¼šåˆ›æ„äº§å‡ºä¸‹é™41%ï¼Œé”™è¯¯ç‡å¢åŠ 63%
            const efficiencyLossMultiplier = sleepDurationScore / 3; // 0-1
            const efficiencyLoss = Math.round(annualIncome * 0.3 * efficiencyLossMultiplier);

            // 4. é¢œå€¼ä¿®å¤æˆæœ¬ï¼šæ ¹æ®æ€§åˆ«å’Œæ—¥é—´åŠŸèƒ½éšœç¢è°ƒæ•´
            // ç”·ç”Ÿï¼šåŸºç¡€100å…ƒ/æœˆï¼Œæ ¹æ®æ—¥é—´åŠŸèƒ½éšœç¢+90å…ƒ/åˆ†ï¼Œæœ€é«˜400å…ƒ/æœˆ
            // å¥³ç”Ÿï¼šåŸºç¡€300å…ƒ/æœˆï¼Œæ ¹æ®æ—¥é—´åŠŸèƒ½éšœç¢+230å…ƒ/åˆ†ï¼Œæœ€é«˜1000å…ƒ/æœˆ
            let beautyCost;
            if (gender === 'male') {
                // ç”·ç”Ÿï¼š1200-4800å…ƒ/å¹´
                beautyCost = Math.round((100 + dayEnergyScore * 90) * 12);
            } else {
                // å¥³ç”Ÿï¼š3600-12000å…ƒ/å¹´
                beautyCost = Math.round((300 + dayEnergyScore * 230) * 12);
            }

            // æ€»æŸå¤±
            const totalLoss = medicalCost + incomeLoss + efficiencyLoss + beautyCost;

            // è®¡ç®—å¥åº·é£é™©
            // ç¡çœ æ—¶é—´ç³»æ•°
            let sleepTimeCoefficient = 0;
            if (sleepTimeHour >= 0 && sleepTimeHour <= 1) sleepTimeCoefficient = 0.5; // 0-2ç‚¹
            else if (sleepTimeHour >= 2) sleepTimeCoefficient = 1.0; // 2ç‚¹å
            else sleepTimeCoefficient = 0; // 12ç‚¹å‰

            // ç†¬å¤œé¢‘ç‡ç³»æ•°
            const stayLateCoefficient = stayLateDays / 7;

            // ç»¼åˆé£é™©ç³»æ•°ï¼ˆ0-1ï¼‰
            const riskCoefficient = (sleepDurationScore + sleepScore + (sleepTimeCoefficient * 3) + (stayLateCoefficient * 3)) / 12;

            // å¥åº·é£é™©
            const heartRiskIncrease = Math.round(92 * riskCoefficient); // 0-92%
            const diabetesRiskIncrease = Math.round(100 * riskCoefficient); // 0-100%
            const cognitiveDecline = Math.round(41 * riskCoefficient); // 0-41%
            const agingYears = (2.2 + 1.2 * riskCoefficient).toFixed(1);
            const depressionRiskIncrease = Math.round(170 * riskCoefficient); // 0-170%

            // å‡»è´¥ç™¾åˆ†æ¯”ï¼ˆåˆ†æ•°è¶Šé«˜ï¼Œå‡»è´¥è¶Šå°‘ï¼‰
            const beatPercent = Math.max(5, Math.min(95, 100 - (sleepScore / 9) * 90));

            // æ›´æ–°ç•Œé¢
            document.getElementById('totalLoss').textContent = totalLoss.toLocaleString();
            document.getElementById('beatPercent').textContent = beatPercent.toFixed(0) + '%';
            document.getElementById('sleepScore').textContent = sleepScore;
            
            document.getElementById('medicalCost').textContent = medicalCost.toLocaleString() + ' å…ƒ/å¹´';
            document.getElementById('incomeLoss').textContent = incomeLoss.toLocaleString() + ' å…ƒ/å¹´';
            document.getElementById('efficiencyLoss').textContent = efficiencyLoss.toLocaleString() + ' å…ƒ/å¹´';
            document.getElementById('beautyCost').textContent = beautyCost.toLocaleString() + ' å…ƒ/å¹´';

            // æ·»åŠ æˆæœ¬è§£é‡Š
            if (medicalCost > 0) {
                document.getElementById('medicalCostExplanation').textContent = 
                    `åŸºç¡€ï¼š8300å…ƒ/å¹´ï¼ˆç¾å›½ç ”ç©¶ï¼šç¡çœ <6å°æ—¶å¹´å‡å¤šæ”¯å‡º1278ç¾å…ƒï¼‰`;
            } else {
                document.getElementById('medicalCostExplanation').textContent = 'ç¡çœ å……è¶³ï¼ŒåŒ»ç–—æ”¯å‡ºæ­£å¸¸';
            }

            if (incomeLoss > 0) {
                document.getElementById('incomeLossExplanation').textContent = 
                    `ç¡çœ ä¸è¶³å¯¼è‡´å¹´æ”¶å…¥å‡å°‘12.5%ï¼ˆç¡çœ ç»æµç ”ç©¶ï¼‰`;
            } else {
                document.getElementById('incomeLossExplanation').textContent = 'ç¡çœ å……è¶³ï¼Œæ”¶å…¥å½±å“å°';
            }

            if (efficiencyLoss > 0) {
                document.getElementById('efficiencyLossExplanation').textContent = 
                    `åˆ›æ„äº§å‡ºä¸‹é™41%ï¼Œå·¥ä½œå¤±è¯¯ç‡å¢åŠ 63%ï¼ˆNatureç ”ç©¶ï¼‰`;
            } else {
                document.getElementById('efficiencyLossExplanation').textContent = 'ç¡çœ å……è¶³ï¼Œå·¥ä½œæ•ˆç‡æ­£å¸¸';
            }

            if (beautyCost > 0) {
                if (gender === 'male') {
                    document.getElementById('beautyCostExplanation').textContent = 
                        `ç”·ç”Ÿï¼š100-400å…ƒ/æœˆ Ã— 12ï¼ˆæŠ¤è‚¤ã€å¤´å‘æŠ¤ç†ç­‰ï¼‰`;
                } else {
                    document.getElementById('beautyCostExplanation').textContent = 
                        `å¥³ç”Ÿï¼š300-1000å…ƒ/æœˆ Ã— 12ï¼ˆæŠ¤è‚¤ã€é¢è†œã€å¤´å‘æŠ¤ç†ç­‰ï¼‰`;
                }
            } else {
                document.getElementById('beautyCostExplanation').textContent = 'ç™½å¤©ç²¾åŠ›å……æ²›ï¼Œé¢œå€¼ç»´æŠ¤æˆæœ¬ä½';
            }

            // å¥åº·é£é™©
            if (heartRiskIncrease < 20) {
                document.getElementById('heartRisk').textContent = 'å¿ƒè¡€ç®¡ç–¾ç—…é£é™©ï¼šæ­£å¸¸';
                document.getElementById('heartRisk').style.color = '#4CAF50';
            } else if (heartRiskIncrease < 50) {
                document.getElementById('heartRisk').textContent = `å¿ƒè¡€ç®¡ç–¾ç—…é£é™©ï¼šå¢åŠ  ${heartRiskIncrease}%`;
                document.getElementById('heartRisk').style.color = '#FF9800';
            } else {
                document.getElementById('heartRisk').textContent = `å¿ƒè¡€ç®¡ç–¾ç—…é£é™©ï¼šå¢åŠ  ${heartRiskIncrease}% âš ï¸`;
                document.getElementById('heartRisk').style.color = '#F44336';
            }

            if (diabetesRiskIncrease < 20) {
                document.getElementById('diabetesRisk').textContent = 'ç³–å°¿ç—…é£é™©ï¼šæ­£å¸¸';
                document.getElementById('diabetesRisk').style.color = '#4CAF50';
            } else if (diabetesRiskIncrease < 50) {
                document.getElementById('diabetesRisk').textContent = `ç³–å°¿ç—…é£é™©ï¼šå¢åŠ  ${diabetesRiskIncrease}%`;
                document.getElementById('diabetesRisk').style.color = '#FF9800';
            } else {
                document.getElementById('diabetesRisk').textContent = `ç³–å°¿ç—…é£é™©ï¼šå¢åŠ  ${diabetesRiskIncrease}% âš ï¸`;
                document.getElementById('diabetesRisk').style.color = '#F44336';
            }

            if (cognitiveDecline < 15) {
                document.getElementById('brainRisk').textContent = 'è®¤çŸ¥åŠŸèƒ½ï¼šæ­£å¸¸';
                document.getElementById('brainRisk').style.color = '#4CAF50';
            } else if (cognitiveDecline < 30) {
                document.getElementById('brainRisk').textContent = `è®¤çŸ¥åŠŸèƒ½ä¸‹é™ ${cognitiveDecline}%`;
                document.getElementById('brainRisk').style.color = '#FF9800';
            } else {
                document.getElementById('brainRisk').textContent = `è®¤çŸ¥åŠŸèƒ½ä¸‹é™ ${cognitiveDecline}% ğŸš¨`;
                document.getElementById('brainRisk').style.color = '#F44336';
            }

            document.getElementById('agingRisk').textContent = `è¡°è€åŠ é€Ÿï¼š${agingYears} å¹´`;

            if (depressionRiskIncrease < 30) {
                document.getElementById('depressionRisk').textContent = 'æŠ‘éƒé£é™©ï¼šæ­£å¸¸';
                document.getElementById('depressionRisk').style.color = '#4CAF50';
            } else if (depressionRiskIncrease < 70) {
                document.getElementById('depressionRisk').textContent = `æŠ‘éƒé£é™©ï¼šå¢åŠ  ${depressionRiskIncrease}%`;
                document.getElementById('depressionRisk').style.color = '#FF9800';
            } else {
                document.getElementById('depressionRisk').textContent = `æŠ‘éƒé£é™©ï¼šå¢åŠ  ${depressionRiskIncrease}% âš ï¸`;
                document.getElementById('depressionRisk').style.color = '#F44336';
            }

            // ç»“æœå¡ç‰‡é¢œè‰²
            const resultCard = document.getElementById('resultCard');
            if (sleepScore >= 7) {
                resultCard.classList.add('danger');
            } else if (sleepScore >= 4) {
                resultCard.classList.add('warning');
            }

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('step' + currentStep).classList.remove('active');
            currentStep = 4;
            document.getElementById('step' + currentStep).classList.add('active');
            updateProgress();
            window.scrollTo(0, 0);
        }

        // é€‰é¡¹ç‚¹å‡»æ•ˆæœ
        document.querySelectorAll('.radio-option').forEach(option => {
            option.addEventListener('click', function(e) {
                const parent = this.closest('.radio-group');
                parent.querySelectorAll('.radio-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

        // åˆå§‹åŒ–
        updateProgress();
    </script>
</body>
</html>
